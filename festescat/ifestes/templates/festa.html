{% extends "layout.html" %}
{% load ifusergroup %}
{% block content %}
<div id="LlistaElems" class="col-md-8">
<h1>Festa</h1>
{% if festes %}
    {% ifusergroup Organitzadors %}
    <form id='formulari' method="PUT" action="delete/">
        <button class="btn btn-primary" type="submit">
            <span class="glyphicon glyphicon-remove"> Elimina la festa</span>
        </button>
    </form>
    <div class="new-button">
        <form id='formulari' method="PUT" action="edit/">
            <button class="btn btn-primary" type="submit">
                {% comment %} onclick="showAddForm()">{% endcomment %}
                <span class="glyphicon glyphicon-pencil"> Edita la Festa</span>
            </button>
        </form>
    </div>
    {% endifusergroup %}
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-8">
                <p>Nom: {{ festes.nom }}</p>
                <p>Data d'inici: {{ festes.data_inici }}</p>
                <p>Data de finalització: {{ festes.data_fi }}</p>
                <p>Categoria: {{ festes.categoria}}</p>
                <p>Descripció: {{ festes.descripcio }}</p>
                <p>Localitat: {{ festes.localitat }}</p>
                {% if events %}
                <h2>Events</h2>
                    <ul>
                    {% for event in events %}
                        <li><p><a href="/events/{{event.id}}/"><h3>{{event.nom}}</h3></a></p></li>
                    {% endfor %}
                    </ul>
                {% else %}
                <p>No hi ha cap event</p>
                {% endif %}
                <div id="reviews">
                    <h3>Reviews</h3>
                    {% if festes.festesreview_set %}
                        <span rel="aggregateRating">
                            <p typeof="AggregateRating">
                                <strong>Global rate: {{mitja}}</strong>
                                <span property="ratingValue">{{festa.averageRating|stringformat:".1f"}}<span>
                    {% endif %}
                    {% for review in festes.festesreview_set.all %}
                        <p rel="reviewRating" typeof="Rating">
                            Rating: {{ review.rating}}
                        </p>
                    {% empty %}
                        <p>No hi ha reviews</p>
                    {% endfor %}
                </div>
            </div>
            <div class="col-md-4">
                <form id='formulari' method="POST" action="/festes/{{festes.id}}/assist/">
                    {% csrf_token %}
                    <button class="btn btn-primary asis-button" type="submit">
                        <span class="glyphicon glyphicon-ok"> Participa-hi</span>
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>
{% else %}
    <p>No existeix aquesta festa.</p>
</div>
{% endif %}
{% endblock %}
